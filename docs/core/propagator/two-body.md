# 二体预报器

## 概述

二体预报器基于开普勒方程的解析解，提供理想二体问题的轨道预报功能。该方法计算效率高，适用于对精度要求不高的快速轨道预报场景。

## 核心概念

### 二体问题

二体问题假设系统中只有两个质点，在相互引力作用下运动。该问题有解析解，轨道形状为圆锥曲线（椭圆、抛物线或双曲线）。

### 预报原理

二体预报器使用开普勒方程计算给定时间间隔后的轨道状态

## 主要接口

### 函数接口

```cpp
AST_CORE_CAPI err_t aTwoBodyProp(double duration, double gm, Vector3d& r, Vector3d& v);
```

**参数说明：**

- `duration`：传播时间间隔（秒）
- `gm`：引力常数（m³/s²）
- `r`：输入/输出位置向量（米）
- `v`：输入/输出速度向量（米/秒）

**返回值：**

- 成功返回 `0`
- 失败返回相应的错误码

## 用法示例

### 1. 基本二体传播

@[code](/examples/propagator/two_body/twobody_basic_propagation.cpp)

### 2. 地球轨道传播

@[code](/examples/propagator/two_body/twobody_earth_orbit.cpp)

## 精度与限制

### 精度特点

- **计算精度**：解析解，理论上无截断误差
- **适用范围**：理想二体问题，忽略所有摄动力
- **计算效率**：非常高，适合需要极高计算效率的应用

### 使用限制

- 不适用于需要考虑地球扁率、大气阻力、三体引力等摄动力的场景
- 长时间传播时，由于模型简化，误差会累积
- 对于高精度轨道预报需求，建议使用HPOP等数值方法

## 注意事项

- 输入的位置和速度向量应在同一惯性坐标系下
- 引力常数应与中心天体匹配
- 传播时间间隔不宜过长，避免数值误差累积
- 对于近圆轨道，计算精度较高；对于高偏心率轨道，需要注意数值稳定性

## API参考

@[code](/src/AstCore/Propagator/TwoBody.hpp)