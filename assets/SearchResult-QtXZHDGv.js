import{f as W,u as N,g as X,h as Z,j as ee,t as ae,i as te,k as D,l as w,m as e,n as le,w as re,s as se,R as F,p as oe,q as ie,v as ce,x as ue,y as ne,z as I,A as T,B as me,C as he,D as ve,E as de,L as pe,F as ye,G as ge,H as fe,I as U,J as He,K as x}from"./app-BCdZP3FX.js";const be=["/","/core/","/core/frame-transform.html","/core/orbit-element.html","/core/orbit-param.html","/core/sofa.html","/core/time.html","/en/","/dev/","/dev/math.html","/math/","/math/attitude.html","/math/ode.html","/math/operator.html","/util/","/util/literals.html","/util/quantity.html","/util/smart-pointer.html","/core/propagator/","/core/propagator/hpop.html","/core/propagator/j2-analytical.html","/core/propagator/j4-analytical.html","/core/propagator/two-body.html","/en/core/","/en/core/frame-transform.html","/en/core/orbit-element.html","/en/core/orbit-param.html","/en/core/sofa.html","/en/core/time.html","/en/math/","/en/math/attitude.html","/en/math/operator.html","/en/util/","/en/util/literals.html","/en/util/quantity.html","/en/util/smart-pointer.html","/en/core/propagator/","/en/core/propagator/hpop.html","/en/core/propagator/j2-analytical.html","/en/core/propagator/j4-analytical.html","/en/core/propagator/two-body.html","/404.html"],ke="SLIMSEARCH_QUERY_HISTORY",g=U(ke,[]),we=()=>{const{queryHistoryCount:r}=x;return{enabled:r>0,queryHistories:g,addQueryHistory:c=>{g.value=Array.from(new Set([c,...g.value.slice(0,r-1)]))},removeQueryHistory:c=>{g.value=[...g.value.slice(0,c),...g.value.slice(c+1)]}}},$=r=>be[r.id]+("anchor"in r?`#${r.anchor}`:""),xe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=x,f=U(xe,[]),Re=()=>({enabled:M>0,resultHistories:f,addResultHistory:i=>{{const c={link:$(i),display:i.display};"header"in i&&(c.header=i.header),f.value=[c,...f.value.slice(0,M-1)]}},removeResultHistory:i=>{f.value=[...f.value.slice(0,i),...f.value.slice(i+1)]}}),qe=r=>{const{page:i,routeLocale:c}=me(),R=he(),s=D(0),H=w(()=>s.value>0),m=ve([]);return de(()=>{const{search:q,terminate:d}=pe(),b=ge(p=>{const{resultsFilter:Q=l=>l,querySplitter:y,suggestionsFilter:j,...o}=R.value;p?(s.value+=1,q(p,c.value,o).then(l=>Q(l,p,c.value,i.value)).then(l=>{s.value-=1,m.value=l}).catch(l=>{console.warn(l),s.value-=1,s.value||(m.value=[])})):m.value=[]},x.searchDelay-x.suggestDelay,{maxWait:5e3});ye([r,c],([p])=>b(p.join(" "))),fe(()=>{d()})}),{isSearching:H,results:m}};var Se=W({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(r,{emit:i}){const c=N(),R=X(),s=Z(ee),{addQueryHistory:H,queryHistories:m,removeQueryHistory:q}=we(),{resultHistories:d,addResultHistory:b,removeResultHistory:p}=Re(),Q=ae(r,"queries"),{results:y,isSearching:j}=qe(Q),o=te({isQuery:!0,index:0}),l=D(0),h=D(0),A=w(()=>m.value.length>0||d.value.length>0),S=w(()=>y.value.length>0),C=w(()=>y.value[l.value]||null),_=()=>{const{isQuery:a,index:t}=o;t===0?(o.isQuery=!a,o.index=a?d.value.length-1:m.value.length-1):o.index=t-1},O=()=>{const{isQuery:a,index:t}=o;t===(a?m.value.length-1:d.value.length-1)?(o.isQuery=!a,o.index=0):o.index=t+1},P=()=>{l.value=l.value>0?l.value-1:y.value.length-1,h.value=C.value.contents.length-1},Y=()=>{l.value=l.value<y.value.length-1?l.value+1:0,h.value=0},B=()=>{h.value<C.value.contents.length-1?h.value+=1:Y()},z=()=>{h.value>0?h.value-=1:P()},L=a=>a.map(t=>He(t)?t:e(t[0],t[1])),G=a=>{if(a.type==="customField"){const t=ue[a.index]||"$content",[v,u=""]=ne(t)?t[R.value].split("$content"):t.split("$content");return a.display.map(n=>e("div",L([v,...n,u])))}return a.display.map(t=>e("div",L(t)))},k=()=>{l.value=0,h.value=0,i("updateQuery",""),i("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},s.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},m.value.map((a,t)=>{const v=o.isQuery&&o.index===t;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v,onClick:()=>{i("updateQuery",a)}},e("div",[e(I,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},a),e("button",{type:"button",class:"slimsearch-remove-icon",title:s.value.remove,"aria-label":s.value.remove,innerHTML:T,onClick:u=>{u.preventDefault(),u.stopPropagation(),q(t)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},s.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((a,t)=>{const v=!o.isQuery&&o.index===t;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v},e(F,{to:a.link,onClick:()=>{k()}},()=>[e(I,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[a.header?e("div",{class:"slimsearch-record-content-header"},a.header):null,e("div",a.display.map(u=>L(u)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:s.value.remove,"aria-label":s.value.remove,innerHTML:T,onClick:u=>{u.preventDefault(),u.stopPropagation(),p(t)}})]))}))]));return le("keydown",a=>{if(r.isFocusing){if(S.value){if(a.key==="ArrowUp")z();else if(a.key==="ArrowDown")B();else if(a.key==="Enter"){const t=C.value.contents[h.value];H(r.queries.join(" ")),b(t),c.push($(t)),k()}}else if(a.key==="ArrowUp")_();else if(a.key==="ArrowDown")O();else if(a.key==="Enter"){const{index:t}=o;o.isQuery?(a.preventDefault(),i("updateQuery",m.value[t])):(c.push(d.value[t].link),k())}}}),re([l,h],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:r.queries.length?!S.value:!A.value}]},r.queries.length?j.value?e(se,{hint:s.value.searching}):S.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},y.value.map(({title:a,contents:t},v)=>{const u=l.value===v;return e("div",{class:["slimsearch-record",{active:u}],role:"group","aria-selected":u},[e("div",{class:"slimsearch-record-title"},a||s.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},t.map((n,V)=>{const E=u&&h.value===V;return e("li",{class:["slimsearch-record-matches",{active:E}],role:"option","aria-selected":E},e(F,{to:$(n),onClick:()=>{H(r.queries.join(" ")),b(n),k()}},()=>[n.type==="text"?null:e(n.type==="title"?oe:n.type==="heading"?ie:ce,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[n.type==="text"&&n.header?e("div",{class:"slimsearch-record-content-header"},n.header):null,e("div",G(n))])]))}))])})):s.value.emptyResult:A.value?[J(),K()]:s.value.emptyHistory)}});export{Se as default};
