import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as t}from"./app-B6N7OXC0.js";const l={};function e(h,s){return t(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="æ™ºèƒ½æŒ‡é’ˆ" tabindex="-1"><a class="header-anchor" href="#æ™ºèƒ½æŒ‡é’ˆ"><span>æ™ºèƒ½æŒ‡é’ˆ</span></a></h1><p>ast é¡¹ç›®æä¾›äº†ä¸‰ç§æ™ºèƒ½æŒ‡é’ˆå®ç°ï¼Œç”¨äºå®‰å…¨åœ°ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ‚¬ç©ºæŒ‡é’ˆé—®é¢˜ã€‚</p><h2 id="sharedptr" tabindex="-1"><a class="header-anchor" href="#sharedptr"><span>SharedPtr</span></a></h2><p>å…±äº«æŒ‡é’ˆå®ç°ï¼Œç±»ä¼¼äº C++ æ ‡å‡†åº“çš„ <code>std::shared_ptr</code>ï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°æœºåˆ¶å®ç°èµ„æºå…±äº«ã€‚</p><h3 id="é‡è¦é™åˆ¶" tabindex="-1"><a class="header-anchor" href="#é‡è¦é™åˆ¶"><span>é‡è¦é™åˆ¶</span></a></h3><p><strong>SharedPtråªèƒ½ç”¨äºç»§æ‰¿è‡ªObjectç±»å‹çš„ç±»</strong>ï¼Œå› ä¸ºå®ƒä¾èµ–äºObjectåŸºç±»æä¾›çš„å¼•ç”¨è®¡æ•°æ–¹æ³•ï¼ˆ<code>incRef()</code>å’Œ<code>decRef()</code>ï¼‰ã€‚</p><h3 id="ä¸»è¦ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#ä¸»è¦ç‰¹ç‚¹"><span>ä¸»è¦ç‰¹ç‚¹</span></a></h3><ul><li>æ”¯æŒå¤šä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</li><li>å½“æœ€åä¸€ä¸ªå¼•ç”¨è¢«é”€æ¯æ—¶ï¼Œå¯¹è±¡ä¼šè¢«æ­£ç¡®é‡Šæ”¾</li><li>æä¾›è‡ªåŠ¨ç±»å‹è½¬æ¢å’Œç®­å¤´æ“ä½œç¬¦é‡è½½</li></ul><h3 id="æ ¸å¿ƒæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ–¹æ³•"><span>æ ¸å¿ƒæ–¹æ³•</span></a></h3><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>æ„é€ å‡½æ•°</td><td>æ”¯æŒé»˜è®¤æ„é€ ã€é€šè¿‡åŸå§‹æŒ‡é’ˆæ„é€ å’Œæ‹·è´æ„é€ </td></tr><tr><td>ææ„å‡½æ•°</td><td>å‡å°‘å¼•ç”¨è®¡æ•°ï¼Œå¿…è¦æ—¶é‡Šæ”¾å¯¹è±¡</td></tr><tr><td><code>operator=</code></td><td>èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼Œæ”¯æŒä»å…¶ä»– SharedPtr æˆ–åŸå§‹æŒ‡é’ˆèµ‹å€¼</td></tr><tr><td><code>operator-&gt;</code></td><td>æä¾›å¯¹è¢«ç®¡ç†å¯¹è±¡çš„æˆå‘˜è®¿é—®</td></tr><tr><td><code>get()</code></td><td>è·å–åŸå§‹æŒ‡é’ˆ</td></tr></tbody></table><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/SharedPtr.hpp&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/Object.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _AST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Object</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> doSomething</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* todo: implement functionality */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    AST_USING_NAMESPACE </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // åˆ›å»ºå…±äº«æŒ‡é’ˆå¯¹è±¡ï¼ˆåªèƒ½ç”¨äºObjectçš„å­ç±»ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    SharedPtr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MyObjectå¿…é¡»ç»§æ‰¿è‡ªObject</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å…±äº«æ‰€æœ‰æƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    SharedPtr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr1;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // è®¿é—®å¯¹è±¡æˆå‘˜</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    ptr1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">doSomething</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // è·å–åŸå§‹æŒ‡é’ˆ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> rawPtr </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ptr1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="scopedptr" tabindex="-1"><a class="header-anchor" href="#scopedptr"><span>ScopedPtr</span></a></h2><p>ä½œç”¨åŸŸæŒ‡é’ˆï¼Œç”¨äºç®¡ç†å•ä¸€æ‰€æœ‰æƒçš„èµ„æºï¼Œç”Ÿå‘½å‘¨æœŸä¸¥æ ¼é™åˆ¶åœ¨ä½œç”¨åŸŸå†…ã€‚</p><h3 id="ä¸»è¦ç‰¹ç‚¹-1" tabindex="-1"><a class="header-anchor" href="#ä¸»è¦ç‰¹ç‚¹-1"><span>ä¸»è¦ç‰¹ç‚¹</span></a></h3><ul><li>ç‹¬å æ‰€æœ‰æƒï¼Œç¦æ­¢å¤åˆ¶å’Œèµ‹å€¼æ“ä½œ</li><li>ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾èµ„æº</li><li>æä¾›è‡ªå®šä¹‰åˆ é™¤å™¨ï¼Œå¯¹Objectç±»å‹æœ‰ç‰¹æ®Šå¤„ç†ï¼ˆè°ƒç”¨<code>destruct()</code>æ–¹æ³•ï¼‰</li><li>å¯ä»¥ç”¨äºæ™®é€šç±»å‹å’ŒObjectçš„å­ç±»</li></ul><h3 id="æ ¸å¿ƒæ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ–¹æ³•-1"><span>æ ¸å¿ƒæ–¹æ³•</span></a></h3><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>æ„é€ å‡½æ•°</td><td>æ”¯æŒé»˜è®¤æ„é€ å’Œé€šè¿‡åŸå§‹æŒ‡é’ˆæ„é€ </td></tr><tr><td>ææ„å‡½æ•°</td><td>è‡ªåŠ¨é‡Šæ”¾ç®¡ç†çš„èµ„æº</td></tr><tr><td><code>reset()</code></td><td>é‡ç½®æŒ‡é’ˆï¼Œé‡Šæ”¾åŸæœ‰èµ„æºå¹¶æ¥ç®¡æ–°èµ„æº</td></tr><tr><td><code>get()</code></td><td>è·å–åŸå§‹æŒ‡é’ˆ</td></tr></tbody></table><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/ScopedPtr.hpp&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/Object.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _AST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Object</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> doSomething</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* todo: implement functionality */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    AST_USING_NAMESPACE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // ä½œç”¨åŸŸå¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // å¯ä»¥ç”¨äºæ™®é€šç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ScopedPtr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> intPtr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">42</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // ä¹Ÿå¯ä»¥ç”¨äºObjectå­ç±»ï¼ˆæœ‰ç‰¹æ®Šçš„åˆ é™¤å¤„ç†ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ScopedPtr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> objPtr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MyObjectå¿…é¡»ç»§æ‰¿è‡ªObject</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        objPtr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">doSomething</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // é‡ç½®æŒ‡é’ˆ</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        objPtr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="weakptr" tabindex="-1"><a class="header-anchor" href="#weakptr"><span>WeakPtr</span></a></h2><p>å¼±å¼•ç”¨æŒ‡é’ˆï¼Œç±»ä¼¼äº C++ æ ‡å‡†åº“çš„ <code>std::weak_ptr</code>ï¼Œä¸å¢åŠ å¼•ç”¨è®¡æ•°ï¼Œé¿å…å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p><h3 id="é‡è¦é™åˆ¶-1" tabindex="-1"><a class="header-anchor" href="#é‡è¦é™åˆ¶-1"><span>é‡è¦é™åˆ¶</span></a></h3><p><strong>WeakPtråªèƒ½ç”¨äºç»§æ‰¿è‡ªObjectç±»å‹çš„ç±»</strong>ï¼Œå› ä¸ºå®ƒä¾èµ–äºObjectåŸºç±»æä¾›çš„å¼±å¼•ç”¨è®¡æ•°æ–¹æ³•ï¼ˆ<code>incWeakRef()</code>ã€<code>decWeakRef()</code>ï¼‰å’Œé”€æ¯çŠ¶æ€æ£€æŸ¥ï¼ˆ<code>isDestructed()</code>ï¼‰ã€‚</p><h3 id="ä¸»è¦ç‰¹ç‚¹-2" tabindex="-1"><a class="header-anchor" href="#ä¸»è¦ç‰¹ç‚¹-2"><span>ä¸»è¦ç‰¹ç‚¹</span></a></h3><ul><li>ä¸å½±å“å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œåªå¢åŠ å¼±å¼•ç”¨è®¡æ•°</li><li>å¯ä»¥æ£€æµ‹å¯¹è±¡æ˜¯å¦å·²è¢«é”€æ¯</li><li>æä¾›è®¿é—®å¯¹è±¡çš„å®‰å…¨æœºåˆ¶</li></ul><h3 id="æ ¸å¿ƒæ–¹æ³•-2" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ–¹æ³•-2"><span>æ ¸å¿ƒæ–¹æ³•</span></a></h3><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>æ„é€ å‡½æ•°</td><td>æ”¯æŒé»˜è®¤æ„é€ ã€é€šè¿‡åŸå§‹æŒ‡é’ˆæ„é€ å’Œæ‹·è´æ„é€ </td></tr><tr><td>ææ„å‡½æ•°</td><td>å‡å°‘å¼±å¼•ç”¨è®¡æ•°</td></tr><tr><td><code>operator=</code></td><td>èµ‹å€¼è¿ç®—ç¬¦é‡è½½</td></tr><tr><td><code>lock()</code></td><td>è·å–åŸå§‹æŒ‡é’ˆï¼ˆä¸æ£€æŸ¥å¯¹è±¡æ˜¯å¦å·²é”€æ¯ï¼‰</td></tr><tr><td><code>get()</code></td><td>å®‰å…¨è·å–æŒ‡é’ˆï¼Œæ£€æŸ¥å¯¹è±¡æ˜¯å¦å·²é”€æ¯</td></tr></tbody></table><h3 id="ä½¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-2"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/WeakPtr.hpp&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/SharedPtr.hpp&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;AstUtil/Object.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _AST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Object</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> doSomething</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* todo: implement functionality */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    AST_USING_NAMESPACE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // åˆ›å»ºå…±äº«æŒ‡é’ˆï¼ˆåªèƒ½ç”¨äºObjectçš„å­ç±»ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    SharedPtr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> shared </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> MyObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MyObjectå¿…é¡»ç»§æ‰¿è‡ªObject</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // åˆ›å»ºå¼±å¼•ç”¨æŒ‡é’ˆ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WeakPtr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> weak </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> shared</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å®‰å…¨è®¿é—®å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (MyObject</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> weak</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">doSomething</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ™ºèƒ½æŒ‡é’ˆçš„ä½¿ç”¨å»ºè®®" tabindex="-1"><a class="header-anchor" href="#æ™ºèƒ½æŒ‡é’ˆçš„ä½¿ç”¨å»ºè®®"><span>æ™ºèƒ½æŒ‡é’ˆçš„ä½¿ç”¨å»ºè®®</span></a></h2><ol><li><strong>ä¼˜å…ˆä½¿ç”¨ ScopedPtr</strong>ï¼šå½“èµ„æºä»…åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…ä½¿ç”¨æ—¶</li><li><strong>ä½¿ç”¨ SharedPtr</strong>ï¼šå½“éœ€è¦å¤šä¸ªæŒ‡é’ˆå…±äº«åŒä¸€èµ„æºæ—¶ï¼ˆä»…é€‚ç”¨äºObjectçš„å­ç±»ï¼‰</li><li><strong>ä½¿ç”¨ WeakPtr</strong>ï¼šå½“éœ€è¦å¼•ç”¨å…±äº«èµ„æºä½†ä¸å¸Œæœ›å½±å“å…¶ç”Ÿå‘½å‘¨æœŸæ—¶ï¼ˆä»…é€‚ç”¨äºObjectçš„å­ç±»ï¼‰ï¼Œç‰¹åˆ«æ˜¯é¿å…å¾ªç¯å¼•ç”¨</li><li><strong>é¿å…åŸå§‹æŒ‡é’ˆ</strong>ï¼šå°½å¯èƒ½ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆæ›¿ä»£åŸå§‹æŒ‡é’ˆç®¡ç†åŠ¨æ€èµ„æº</li><li><strong>æ³¨æ„ç±»å‹å®‰å…¨</strong>ï¼šç¡®ä¿æ™ºèƒ½æŒ‡é’ˆçš„æ¨¡æ¿ç±»å‹ä¸å®é™…ç®¡ç†çš„å¯¹è±¡ç±»å‹åŒ¹é…ï¼Œç‰¹åˆ«æ³¨æ„SharedPtrå’ŒWeakPtråªèƒ½ç”¨äºObjectçš„å­ç±»</li></ol>`,32)])])}const d=i(l,[["render",e]]),r=JSON.parse('{"path":"/util/smart-pointer.html","title":"æ™ºèƒ½æŒ‡é’ˆ","lang":"zh-CN","frontmatter":{"description":"æ™ºèƒ½æŒ‡é’ˆ ast é¡¹ç›®æä¾›äº†ä¸‰ç§æ™ºèƒ½æŒ‡é’ˆå®ç°ï¼Œç”¨äºå®‰å…¨åœ°ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ‚¬ç©ºæŒ‡é’ˆé—®é¢˜ã€‚ SharedPtr å…±äº«æŒ‡é’ˆå®ç°ï¼Œç±»ä¼¼äº C++ æ ‡å‡†åº“çš„ std::shared_ptrï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°æœºåˆ¶å®ç°èµ„æºå…±äº«ã€‚ é‡è¦é™åˆ¶ SharedPtråªèƒ½ç”¨äºç»§æ‰¿è‡ªObjectç±»å‹çš„ç±»ï¼Œå› ä¸ºå®ƒä¾èµ–äºObjectåŸºç±»æä¾›çš„å¼•ç”¨è®¡æ•°æ–¹æ³•ï¼ˆincRef(...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"æ™ºèƒ½æŒ‡é’ˆ\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-19T05:42:43.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"space-ast\\",\\"url\\":\\"https://github.com/space-ast\\"}]}"],["meta",{"property":"og:url","content":"https://github.com/space-ast/ast/ast/util/smart-pointer.html"}],["meta",{"property":"og:site_name","content":"ğŸ›°ï¸èˆªå¤©ä»¿çœŸç®—æ³•åº“æ–‡æ¡£"}],["meta",{"property":"og:title","content":"æ™ºèƒ½æŒ‡é’ˆ"}],["meta",{"property":"og:description","content":"æ™ºèƒ½æŒ‡é’ˆ ast é¡¹ç›®æä¾›äº†ä¸‰ç§æ™ºèƒ½æŒ‡é’ˆå®ç°ï¼Œç”¨äºå®‰å…¨åœ°ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ‚¬ç©ºæŒ‡é’ˆé—®é¢˜ã€‚ SharedPtr å…±äº«æŒ‡é’ˆå®ç°ï¼Œç±»ä¼¼äº C++ æ ‡å‡†åº“çš„ std::shared_ptrï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°æœºåˆ¶å®ç°èµ„æºå…±äº«ã€‚ é‡è¦é™åˆ¶ SharedPtråªèƒ½ç”¨äºç»§æ‰¿è‡ªObjectç±»å‹çš„ç±»ï¼Œå› ä¸ºå®ƒä¾èµ–äºObjectåŸºç±»æä¾›çš„å¼•ç”¨è®¡æ•°æ–¹æ³•ï¼ˆincRef(..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-12-19T05:42:43.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-19T05:42:43.000Z"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://github.com/space-ast/ast/ast/en/util/smart-pointer.html"}]]},"git":{"createdTime":1763623963000,"updatedTime":1766122963000,"contributors":[{"name":"axel","username":"axel","email":"space_ast@163.com","commits":2,"url":"https://github.com/axel"}]},"readingTime":{"minutes":2.75,"words":824},"filePathRelative":"util/smart-pointer.md","autoDesc":true}');export{d as comp,r as data};
